"use strict";(self.webpackChunkuligpro=self.webpackChunkuligpro||[]).push([[274],{5368:(e,n,r)=>{r.r(n),r.d(n,{default:()=>$});var t=r(5984),a=r(7528),s=r(477),i=r(49),l=r(6529),o=r(7565),c=r(1047),d=r(4549),m=r(3936),u=r(9442),p=r(3163),x=r.n(p),f=r(723),h=r(7929);const v=e=>{let{open:n,onClose:r,onActivate:t}=e;const a=(0,f.d4)((e=>e.auth.status)),{register:s,handleSubmit:i,formState:{errors:l},reset:o}=(0,u.mN)();return(0,h.jsx)(d.default,{open:n,onClose:()=>{o(),r()},children:(0,h.jsxs)("div",{className:"d-flex flex-column g-20",children:[(0,h.jsxs)("div",{className:"d-flex flex-column g-10",children:[(0,h.jsx)("h2",{children:"Finaliser votre Inscription"}),(0,h.jsx)("p",{children:"Un code a \xe9t\xe9 envoy\xe9 \xe0 votre email, renseign\xe9 le ici."})]}),(0,h.jsxs)("div",{className:"d-flex flex-column g-16",children:[(0,h.jsxs)("form",{className:"d-flex g-10",onSubmit:i(((e,n)=>{n.preventDefault(),t(e)})),children:[(0,h.jsx)("input",{className:x()("field",{"field--error":l.email}),type:"text",placeholder:"Entrer le code",...s("code",{required:!0,minLength:3})}),"loading"===a?(0,h.jsx)(m.A,{color:"success",style:{margin:"auto"}}):(0,h.jsx)("button",{className:"btn",type:"submit",children:"Activer"})]}),(0,h.jsx)("p",{className:"text-12",children:"Si vous ne recevez pas d'e-mail dans les minutes qui suivent, veuillez v\xe9rifier votre dossier de courrier ind\xe9sirable."})]})]})})};var g,j,w=r(9575),C=r(1030),N=r(7654),b=r(7265),S=r(9183);const k=(0,N.J1)(g||(g=(0,a.A)(["\n  mutation RegisterRegularUser(\n    $name: String!\n    $email: String!\n    $tel: String!\n    $password: String!\n  ) {\n    registerRegularUser(\n      UserInput: { name: $name, email: $email, tel: $tel, password: $password }\n    ) {\n      activationToken\n      error {\n        code\n        message\n      }\n    }\n  }\n"]))),y=(0,N.J1)(j||(j=(0,a.A)(["\n  mutation ActivateUser($activationCode: String!, $activationToken: String!) {\n    activateUser(\n      activationInput: {\n        activationCode: $activationCode\n        activationToken: $activationToken\n      }\n    ) {\n      user {\n        name\n        email\n        tel\n        role {\n          name\n        }\n      }\n      accessToken\n      refreshToken\n      error {\n        code\n        message\n      }\n    }\n  }\n"]))),A=e=>{let{standalone:n=!0}=e;const[r,t]=(0,o.useState)(!1),[a]=(0,b.n)(k),[d]=(0,b.n)(y),p=(0,C.Zp)(),g=(0,f.wA)(),j=(0,f.d4)((e=>e.auth.activationToken)),N=((0,f.d4)((e=>e.auth.error)),(0,f.d4)((e=>e.auth.status))),A=(0,f.d4)((e=>e.events.ticketsDesired)),{register:$,handleSubmit:R,formState:{errors:T},control:I,watch:U}=(0,u.mN)({defaultValues:{name:"",numero:"",email:"",password:"",passwordConfirm:""}}),q=n?o.Fragment:l.A,E=n?{}:{className:"card card-padded"};return(0,o.useEffect)((()=>{console.log(j),void 0!==j&&t(!0)}),[N,j]),(0,h.jsxs)(q,{...E,children:[(0,h.jsxs)("div",{className:"d-flex flex-column g-4",children:[(0,h.jsx)("h3",{children:"Creer votre compte"}),(0,h.jsx)("p",{className:"text-12",children:"Remplir le formulaire en dessous pour cr\xe9er un compte"})]}),(0,h.jsxs)("form",{onSubmit:R((async(e,n)=>{n.preventDefault();try{await g((0,S.CC)({getActivationTokenFunc:a,email:e.email,password:e.password,name:e.name,tel:e.numero})).unwrap()}catch(r){c.oR.error(r.message)}})),children:[(0,h.jsxs)("div",{className:"d-flex flex-column g-20",style:{margin:"20px 0 30px"},children:[(0,h.jsx)("input",{className:x()("field",{"field--error":T.name}),type:"text",placeholder:"Entrer votre nom",...$("name",{required:!0})}),(0,h.jsx)(u.xI,{control:I,name:"numero",render:e=>{let{field:{ref:n,value:r,onChange:t}}=e;return(0,h.jsx)(w.K9,{required:!0,value:r,className:x()("field",{"field--error":T.phone}),onChange:e=>t(e.target.value),placeholder:"Entrer votre numero",format:"+225 ##########",mask:"_",getInputRef:n})}}),(0,h.jsx)("input",{className:x()("field",{"field--error":T.email}),type:"text",placeholder:"E-mail",...$("email",{required:!0,pattern:/^\S+@\S+$/i})}),(0,h.jsx)(u.xI,{control:I,name:"password",rules:{required:!0,minLength:8},render:e=>{let{field:{ref:n,onChange:r,value:t},fieldState:{error:a}}=e;return(0,h.jsx)(i.A,{className:x()("field",{"field--error":a}),value:t,onChange:e=>r(e.target.value),placeholder:"Entrer votre mot de passe (minimum 8 charact\xe8res)",innerRef:n})}}),T.password&&(0,h.jsx)("p",{role:"alert",children:"Mot de passe doit atteindre au minimum 8 charact\xe8res"}),(0,h.jsx)(u.xI,{control:I,name:"passwordConfirm",rules:{required:!0,validate:e=>e===U("password")},render:e=>{let{field:{ref:n,onChange:r,value:t},fieldState:{error:a}}=e;return(0,h.jsx)(i.A,{className:x()("field",{"field--error":a}),value:t,onChange:e=>r(e.target.value),placeholder:"Retaper votre mot de passe",innerRef:n})}})]}),"loading"===N?(0,h.jsx)("div",{className:"d-flex justify-content-between align-items-center",children:(0,h.jsx)(m.A,{color:"success",style:{margin:"auto"}})}):(0,h.jsxs)("div",{className:"d-flex justify-content-between align-items-center",children:[(0,h.jsx)("button",{type:"submit",className:"btn btn--sm",children:"Creer compte"}),(0,h.jsx)("button",{className:"text-button text-button--sm",children:(0,h.jsx)(s.k2,{"aria-label":"Inscription",to:"/login",children:"Connexion"})})]})]}),(0,h.jsx)(v,{open:r,onClose:()=>t(!1),onActivate:async(e,n)=>{try{await g((0,S.wQ)({activateUserFunc:d,activationCode:e.code,activationToken:j})).unwrap(),t(!1),Object.keys(A).length>1?p("/payment"):p("/")}catch(r){c.oR.error(r.message)}}})]})},$=()=>(0,h.jsx)(t.A,{title:"Sign Up",children:(0,h.jsx)(A,{})})}}]);
//# sourceMappingURL=274.63f76d04.chunk.js.map
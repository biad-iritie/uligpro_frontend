{"version":3,"file":"static/js/177.fec5d431.chunk.js","mappings":"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","sources":["pages/SignUp.jsx","components/ActivateAccountPopup.jsx","widgets/SignUpForm.jsx"],"sourcesContent":["// components\nimport AuthLayout from '@components/AuthLayout';\nimport SignUpForm from '@widgets/SignUpForm';\n\nconst SignUp = () => {\n    return (\n        <AuthLayout title=\"Sign Up\">\n            <SignUpForm />\n        </AuthLayout>\n    );\n}\n\nexport default SignUp","// components\nimport Popup from \"@components/Popup\";\n//import { toast } from \"react-toastify\";\nimport { CircularProgress } from \"@mui/material\";\n// hooks\nimport { useForm } from \"react-hook-form\";\n\n// utils\nimport classNames from \"classnames\";\nimport PropTypes from \"prop-types\";\nimport { useSelector } from \"react-redux\";\n\nconst ActivateAccountPopup = ({ open, onClose, onActivate }) => {\n  const reqStatus = useSelector((state) => state.auth.status);\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n    reset,\n  } = useForm();\n\n  const handleClose = () => {\n    reset();\n    onClose();\n  };\n\n  const onSubmit = (data, e) => {\n    e.preventDefault();\n\n    //toast.info(`New password was sent to ${data.email}`);\n    onActivate(data);\n    //handleClose();\n  };\n\n  return (\n    <Popup open={open} onClose={handleClose}>\n      <div className=\"d-flex flex-column g-20\">\n        <div className=\"d-flex flex-column g-10\">\n          <h2>Finaliser votre Inscription</h2>\n\n          <p>Un code a été envoyé à votre email, renseigné le ici.</p>\n        </div>\n        <div className=\"d-flex flex-column g-16\">\n          <form className=\"d-flex g-10\" onSubmit={handleSubmit(onSubmit)}>\n            <input\n              className={classNames(\"field\", { \"field--error\": errors.email })}\n              type=\"text\"\n              placeholder=\"Entrer le code\"\n              {...register(\"code\", { required: true, minLength: 3 })}\n            />\n\n            {reqStatus === \"loading\" ? (\n              <CircularProgress color=\"success\" style={{ margin: \"auto\" }} />\n            ) : (\n              <button className=\"btn\" type=\"submit\">\n                Activer\n              </button>\n            )}\n          </form>\n          <p className=\"text-12\">\n            If you don't receive an email within a few minutes, please check\n            your spam folder.\n          </p>\n        </div>\n      </div>\n    </Popup>\n  );\n};\n\nActivateAccountPopup.propTypes = {\n  open: PropTypes.bool.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onActivate: PropTypes.func.isRequired,\n};\n\nexport default ActivateAccountPopup;\n","// components\nimport { NavLink } from \"react-router-dom\";\nimport PasswordInput from \"@components/PasswordInput\";\nimport Spring from \"@components/Spring\";\nimport { Fragment } from \"react\";\nimport { toast } from \"react-toastify\";\nimport ActivateAccountPopup from \"@components/ActivateAccountPopup\";\nimport { CircularProgress } from \"@mui/material\";\n\n// hooks\nimport { useForm, Controller } from \"react-hook-form\";\nimport { PatternFormat } from \"react-number-format\";\nimport { useState, useEffect } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\n\n// utils\nimport classNames from \"classnames\";\n\nimport { gql, useMutation } from \"@apollo/client\";\nimport { useDispatch, useSelector } from \"react-redux\";\n\nimport {\n  getActivationToken,\n  activateUserAccount,\n} from \"./../features/user/userSlice\";\n\nconst ACTIVATION_TOKEN = gql`\n  mutation RegisterRegularUser(\n    $name: String!\n    $email: String!\n    $tel: String!\n    $password: String!\n  ) {\n    registerRegularUser(\n      UserInput: { name: $name, email: $email, tel: $tel, password: $password }\n    ) {\n      activationToken\n      error {\n        code\n        message\n      }\n    }\n  }\n`;\n\nconst ACTIVATE_USER = gql`\n  mutation ActivateUser($activationCode: String!, $activationToken: String!) {\n    activateUser(\n      activationInput: {\n        activationCode: $activationCode\n        activationToken: $activationToken\n      }\n    ) {\n      user {\n        name\n        email\n        tel\n      }\n      accessToken\n      refreshToken\n      error {\n        code\n        message\n      }\n    }\n  }\n`;\n\nconst SignUpForm = ({ standalone = true }) => {\n  const [open, setOpen] = useState(false);\n  const [registerRegularUser] = useMutation(ACTIVATION_TOKEN);\n  const [activateUser] = useMutation(ACTIVATE_USER);\n  const navigate = useNavigate();\n  const dispatch = useDispatch();\n  const activationToken = useSelector((state) => state.auth.activationToken);\n  const error = useSelector((state) => state.auth.error);\n  const reqStatus = useSelector((state) => state.auth.status);\n  const ticketsDesired = useSelector((state) => state.events.ticketsDesired);\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors },\n    control,\n    watch,\n  } = useForm({\n    defaultValues: {\n      name: \"\",\n      numero: \"\",\n      email: \"\",\n      password: \"\",\n      passwordConfirm: \"\",\n    },\n  });\n\n  const Wrapper = standalone ? Fragment : Spring;\n  const wrapperProps = standalone ? {} : { className: \"card card-padded\" };\n\n  const onSubmit = async (data, e) => {\n    e.preventDefault();\n\n    try {\n      await dispatch(\n        getActivationToken({\n          getActivationTokenFunc: registerRegularUser,\n          email: data.email,\n          password: data.password,\n          name: data.name,\n          tel: data.numero,\n        })\n      ).unwrap();\n    } catch (error) {\n      console.log(error);\n    }\n    //console.log(data);\n    //\n    /* toast.success(\n      `Account created! Please check your email ${data.email} to confirm your account.`\n    ); */\n  };\n\n  const handleActivateUser = async (data, e) => {\n    try {\n      await dispatch(\n        activateUserAccount({\n          activateUserFunc: activateUser,\n          activationCode: data.code,\n          activationToken: activationToken,\n        })\n      ).unwrap();\n      setOpen(false);\n      Object.keys(ticketsDesired).length > 1\n        ? navigate(\"/payment\")\n        : navigate(\"/\");\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  useEffect(() => {\n    console.log(activationToken);\n    if (reqStatus === \"failed\" && activationToken !== \"\") {\n      toast.error(error);\n    }\n    if (activationToken !== \"\") {\n      setOpen(true);\n    }\n  }, [reqStatus, activationToken]);\n\n  return (\n    <Wrapper {...wrapperProps}>\n      <div className=\"d-flex flex-column g-4\">\n        <h3>Creer votre compte</h3>\n        <p className=\"text-12\">\n          Remplir le formulaire en dessous pour créer un compte\n        </p>\n      </div>\n      <form onSubmit={handleSubmit(onSubmit)}>\n        <div\n          className=\"d-flex flex-column g-20\"\n          style={{ margin: \"20px 0 30px\" }}\n        >\n          <input\n            className={classNames(\"field\", {\n              \"field--error\": errors.name,\n            })}\n            type=\"text\"\n            placeholder=\"Entrer votre nom\"\n            {...register(\"name\", { required: true })}\n          />\n          <Controller\n            control={control}\n            name=\"numero\"\n            render={({ field: { ref, value, onChange } }) => (\n              <PatternFormat\n                required\n                value={value}\n                //minLength={19}\n                className={classNames(\"field\", {\n                  \"field--error\": errors.phone,\n                })}\n                onChange={(e) => onChange(e.target.value)}\n                placeholder=\"Entrer votre numero\"\n                format=\"+225 ##########\"\n                mask=\"_\"\n                getInputRef={ref}\n              />\n            )}\n          />\n          {/* <input\n            className={classNames(\"field\", { \"field--error\": errors.lastName })}\n            type=\"text\"\n            placeholder=\"Entrer votre numero\"\n            {...register(\"numero\", { required: true })}\n          /> */}\n          <input\n            className={classNames(\"field\", { \"field--error\": errors.email })}\n            type=\"text\"\n            placeholder=\"E-mail\"\n            {...register(\"email\", { required: true, pattern: /^\\S+@\\S+$/i })}\n          />\n          <Controller\n            control={control}\n            name=\"password\"\n            rules={{ required: true, minLength: 8 }}\n            render={({\n              field: { ref, onChange, value },\n              fieldState: { error },\n            }) => (\n              <PasswordInput\n                className={classNames(\"field\", { \"field--error\": error })}\n                value={value}\n                onChange={(e) => onChange(e.target.value)}\n                placeholder=\"Entrer votre mot de passe (minimum 8 charactères)\"\n                innerRef={ref}\n              />\n            )}\n          />\n          {errors.password && (\n            <p role=\"alert\">\n              Mot de passe doit atteindre au minimum 8 charactères\n            </p>\n          )}\n          <Controller\n            control={control}\n            name=\"passwordConfirm\"\n            rules={{\n              required: true,\n              validate: (value) => value === watch(\"password\"),\n            }}\n            render={({\n              field: { ref, onChange, value },\n              fieldState: { error },\n            }) => (\n              <PasswordInput\n                className={classNames(\"field\", { \"field--error\": error })}\n                value={value}\n                onChange={(e) => onChange(e.target.value)}\n                placeholder=\"Retaper votre mot de passe\"\n                innerRef={ref}\n              />\n            )}\n          />\n        </div>\n\n        {reqStatus === \"loading\" ? (\n          <div className=\"d-flex justify-content-between align-items-center\">\n            <CircularProgress color=\"success\" style={{ margin: \"auto\" }} />\n          </div>\n        ) : (\n          <div className=\"d-flex justify-content-between align-items-center\">\n            <button type=\"submit\" className=\"btn btn--sm\">\n              Creer compte\n            </button>\n            <button className=\"text-button text-button--sm\">\n              <NavLink aria-label=\"Inscription\" to=\"/login\">\n                Connexion\n              </NavLink>\n            </button>\n          </div>\n        )}\n      </form>\n      <ActivateAccountPopup\n        open={open}\n        onClose={() => setOpen(false)}\n        onActivate={handleActivateUser}\n      />\n    </Wrapper>\n  );\n};\n\nexport default SignUpForm;\n"],"names":["SignUp","_jsx","AuthLayout","title","children","SignUpForm","_ref","open","onClose","onActivate","reqStatus","useSelector","state","auth","status","register","handleSubmit","formState","errors","reset","useForm","Popup","handleClose","_jsxs","className","onSubmit","data","e","preventDefault","classNames","email","type","placeholder","required","minLength","CircularProgress","color","style","margin","ACTIVATION_TOKEN","gql","_templateObject","_taggedTemplateLiteral","ACTIVATE_USER","_templateObject2","standalone","setOpen","useState","registerRegularUser","useMutation","activateUser","navigate","useNavigate","dispatch","useDispatch","activationToken","error","ticketsDesired","events","control","watch","defaultValues","name","numero","password","passwordConfirm","Wrapper","Fragment","Spring","wrapperProps","useEffect","console","log","toast","async","getActivationToken","getActivationTokenFunc","tel","unwrap","Controller","render","_ref2","field","ref","value","onChange","PatternFormat","phone","target","format","mask","getInputRef","pattern","rules","_ref3","fieldState","PasswordInput","innerRef","role","validate","_ref4","NavLink","to","ActivateAccountPopup","activateUserAccount","activateUserFunc","activationCode","code","Object","keys","length"],"sourceRoot":""}